{% extends 'base.html' %}
{% block title %}Page {{ page_number }} - Coran{% endblock %}
{% block content %}
<section class="max-w-3xl mx-auto px-3 sm:px-4 py-6" data-aos="fade-up">
  <div class="flex items-center justify-between text-[#7da491] mb-4 text-sm">
    <a href="{% if prev_page %}/quran/pages/{{ prev_page }}/{% else %}#{% endif %}?reciter={{ selected_reciter }}" class="{% if not prev_page %}pointer-events-none opacity-40{% endif %}">السابق</a>
    <span class="text-[#6e8f7f]">الصفحة {{ page_number }}</span>
    <a href="{% if next_page %}/quran/pages/{{ next_page }}/{% else %}#{% endif %}?reciter={{ selected_reciter }}" class="{% if not next_page %}pointer-events-none opacity-40{% endif %}">التالي</a>
  </div>

  <div class="bg-[#fdfcf8] rounded-[22px] border border-[#dce8df] shadow-[0_8px_30px_rgba(0,0,0,.10)] px-4 sm:px-8 py-6 sm:py-10">
    <form method="get" class="mb-6 flex items-center justify-center gap-2">
      <select name="reciter" class="rounded-full bg-[#eef6f0] border border-[#cddfd3] px-3 py-2 text-xs sm:text-sm text-[#255f4c]">{% for r in reciters %}<option value="{{ r.id }}" {% if r.id|stringformat:'s' == selected_reciter|stringformat:'s' %}selected{% endif %}>{{ r.reciter_name }}</option>{% endfor %}</select>
      <button class="px-4 py-2 rounded-full bg-[#dceee2] border border-[#c1dccd] text-[#255f4c] text-xs sm:text-sm">تطبيق</button>
    </form>

    {% for v in verses %}
      {% ifchanged v.chapter_id %}
      <div class="mx-auto w-fit mb-4 mt-2 px-5 py-1 rounded-full border border-[#b8d4c1] bg-[#eef6f0]">
        <p class="font-amiri text-2xl sm:text-3xl text-center text-[#2c6d57]" dir="rtl" lang="ar">{{ v.chapter_name_arabic }}</p>
      </div>
      {% endifchanged %}
      <p class="font-amiri text-[2rem] sm:text-[2.4rem] leading-[2.45] text-center text-[#1f1f1f]" dir="rtl" lang="ar">{{ v.text_uthmani }} <span class="inline-flex items-center justify-center min-w-8 h-8 px-1 rounded-full border border-[#a7c8b5] text-[#2f725c] text-[0.95rem] align-middle">{{ v.verse_number }}</span></p>
    {% empty %}
    <p class="text-[#8b949e] text-center">Impossible de charger la page pour le moment.</p>
    {% endfor %}
  </div>

  <div class="mt-5 rounded-xl p-3 bg-[#edf6f1] border border-[#d2e4da]">
    <form action="/quran/pages/1/" method="get" onsubmit="this.action='/quran/pages/' + this.page_number.value + '/';" class="flex flex-wrap items-center justify-center gap-3">
      <label class="text-sm text-[#4c7f6c]">اذهب الى الصفحة</label>
      <input type="number" name="page_number" min="1" max="604" value="{{ page_number }}" class="w-28 rounded-full bg-white border border-[#c8ded1] px-3 py-2 text-sm text-[#255f4c]">
      <input type="hidden" name="reciter" value="{{ selected_reciter }}">
      <button class="px-4 py-2 rounded-full bg-[#dceee2] border border-[#c1dccd] text-[#255f4c] text-sm">فتح</button>
    </form>
  </div>
</section>
{% endblock %}
