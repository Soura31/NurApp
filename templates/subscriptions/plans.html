{% extends 'base.html' %}
{% load currency %}
{% block title %}Plans d'abonnement{% endblock %}
{% block content %}
<div class="text-center mb-10 fade-up">
  <h1 class="heading-xl mb-2">Choisissez votre plan</h1>
  <p class="text-muted max-w-lg mx-auto">Accédez à toutes les fonctionnalités premium de NurCoran et enrichissez votre
    parcours spirituel</p>
</div>

<div class="grid md:grid-cols-3 gap-6 max-w-5xl mx-auto">
  {% for plan in plans %}
  <article class="glass plan-card card-glow p-7 {% if plan.is_popular %}popular{% endif %} fade-up"
    style="transition-delay:{{ forloop.counter0 }}00ms">
    {% if plan.is_popular %}
    <div class="text-center mb-3"><span class="plan-badge"><i data-lucide="star" class="w-3 h-3 inline"></i>
        Populaire</span></div>
    {% endif %}
    <h2 class="text-2xl font-bold text-white text-center">{{ plan.name }}</h2>
    <div class="text-center mt-3">
      <span class="stat-value">{{ plan.price_monthly|fcfa }}</span>
      <span class="text-muted text-sm"> / mois</span>
    </div>
    <p class="text-center text-muted text-sm mt-1">{{ plan.price_yearly|fcfa }} / an</p>
    <div class="divider-gold my-5"></div>
    <ul class="feature-list space-y-2">
      {% for f in plan.features %}<li>{{ f }}</li>{% endfor %}
    </ul>
    {% if user.is_authenticated %}
    <form method="post" action="{% url 'subscriptions:checkout' plan.slug %}" class="mt-6 space-y-3">
      {% csrf_token %}
      <select name="billing_cycle" class="input-nur text-center">
        <option value="monthly">Mensuel</option>
        <option value="yearly">Annuel (économisez)</option>
      </select>
      <button class="btn-gold w-full justify-center">
        <i data-lucide="sparkles" class="w-4 h-4"></i> Souscrire
      </button>
    </form>
    {% else %}
    <a href="/accounts/login/" class="btn-gold w-full justify-center mt-6 block text-center">
      <i data-lucide="log-in" class="w-4 h-4"></i> Se connecter
    </a>
    {% endif %}
  </article>
  {% endfor %}
</div>
{% endblock %}
