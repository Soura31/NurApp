{% extends 'base.html' %}
{% block title %}{{ post.title }}{% endblock %}
{% block content %}
<article class="glass-static p-6 fade-up">
  <h1 class="heading-lg">{{ post.title }}</h1>
  <div class="flex items-center gap-2 mt-2 text-sm text-muted">
    <i data-lucide="user" class="w-3.5 h-3.5"></i>
    <span>{{ post.author.username }}</span>
    <span>·</span>
    <i data-lucide="calendar" class="w-3.5 h-3.5"></i>
    <span>{{ post.created_at }}</span>
  </div>
  <div class="divider-gold"></div>
  <div class="text-gray-200 leading-relaxed">{{ post.content|linebreaks }}</div>
  <form method="post" action="{% url 'community:report' post.id %}" class="mt-4">{% csrf_token %}
    <button class="btn-outline btn-sm text-red-300" style="border-color:rgba(239,68,68,0.3)">
      <i data-lucide="flag" class="w-3.5 h-3.5"></i> Signaler
    </button>
  </form>
</article>

<div class="mt-8">
  <h2 class="heading-lg mb-4"><i data-lucide="message-circle" class="w-5 h-5 inline text-gold mr-1"></i> Réponses</h2>
  <div class="space-y-3">
    {% for r in post.replies.all %}
    <div class="glass card-glow p-4 fade-up">
      <div class="flex items-center gap-2 text-sm text-muted mb-2">
        <i data-lucide="user" class="w-3 h-3"></i> {{ r.author.username }}
        <span>·</span>
        {{ r.created_at|date:'d/m H:i' }}
      </div>
      <p class="text-gray-200">{{ r.content }}</p>
    </div>
    {% endfor %}
  </div>
</div>

{% if user.is_authenticated %}
<div class="mt-6 glass-static p-5 fade-up">
  <form method="post" action="{% url 'community:reply_create' post.id %}" class="space-y-3">
    {% csrf_token %}
    <textarea name="content" rows="4" class="input-nur" placeholder="Votre réponse..."></textarea>
    <button class="btn-gold"><i data-lucide="send" class="w-4 h-4"></i> Répondre</button>
  </form>
</div>
{% endif %}
{% endblock %}