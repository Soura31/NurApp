{% extends 'base.html' %}
{% block title %}Communaute{% endblock %}
{% block content %}
<section class="max-w-7xl mx-auto px-4 sm:px-6 py-10" data-aos="fade-up">
  <div class="flex flex-wrap items-center justify-between gap-4">
    <h1 class="font-cinzel text-4xl text-white">Communaute</h1>
    <a href="#new-post" class="px-5 py-3 rounded-xl text-[#080c10] font-semibold" style="background:var(--nur-gold-gradient)">Nouveau post</a>
  </div>
  <div class="grid lg:grid-cols-[280px,1fr] gap-6 mt-6">
    <aside class="rounded-2xl bg-[#161b22] border border-[#c9a84c]/20 p-4">
      <p class="text-[#f0c060] font-semibold mb-3">Categories</p>
      <div class="space-y-2">
        {% for c in categories %}
        <a href="/community/category/{{ c.slug }}/" class="block p-3 rounded-xl border border-white/5 hover:border-[#c9a84c]/30 text-[#e6edf3]">{{ c.name }} {% if c.is_premium %}<span class="text-xs text-[#c9a84c]">Premium</span>{% endif %}</a>
        {% endfor %}
      </div>
    </aside>

    <section>
      {% for c in categories %}
      <article class="rounded-2xl p-5 mb-4" style="background:rgba(201,168,76,.02);border:1px solid rgba(255,255,255,.05)">
        <div class="flex items-center justify-between"><h2 class="text-white font-semibold">{{ c.name }}</h2><a href="/community/category/{{ c.slug }}/" class="text-[#c9a84c] text-sm">Voir</a></div>
        <p class="text-[#8b949e] text-sm mt-2">{{ c.description|default:'Espace d echange spirituel et d entraide.' }}</p>
      </article>
      {% endfor %}

      {% if user.is_authenticated %}
      <form id="new-post" method="post" action="/community/post/new/" class="rounded-2xl p-5 bg-[#161b22] border border-[#c9a84c]/20 mt-6">{% csrf_token %}
        <p class="text-[#f0c060] font-semibold mb-3">Creer un post</p>
        <select name="category" class="w-full rounded-xl bg-[#0d1117] border border-[#c9a84c]/20 px-3 py-2 text-white mb-3">{% for c in categories %}<option value="{{ c.id }}">{{ c.name }}</option>{% endfor %}</select>
        <input name="title" placeholder="Titre" class="w-full rounded-xl bg-[#0d1117] border border-[#c9a84c]/20 px-3 py-2 text-white mb-3">
        <textarea name="content" rows="4" placeholder="Votre message" class="w-full rounded-xl bg-[#0d1117] border border-[#c9a84c]/20 px-3 py-2 text-white"></textarea>
        <button class="mt-3 px-5 py-2 rounded-xl text-[#080c10] font-semibold" style="background:var(--nur-gold-gradient)">Publier</button>
      </form>
      {% endif %}
    </section>
  </div>
</section>
{% endblock %}
